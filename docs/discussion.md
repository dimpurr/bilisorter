# BiliSorter æŠ€æœ¯é€‰å‹ä¸åŠŸèƒ½é›†è®¨è®º

> 2026-02-17 Â· æŠ€æœ¯é€‰å‹è¾©è®ºã€åŠŸèƒ½å­é›†å®šä¹‰ã€æ¶æ„å†³ç­–

---

## ç”¨æˆ·é—®é¢˜åŸæ–‡

> æŠ€æœ¯é€‰å‹ä½ çœ‹çœ‹ /Users/dimpurr/Workflow/Code/parallels/3rd/papper-3rd/apps/reedle-extension ä¸€æ ·çš„æ’ä»¶æŠ€æœ¯é€‰å‹ï¼Œæ— åç«¯ï¼Œå¼€æºï¼Œç„¶ååŠŸèƒ½é›†åˆï¼Œæˆ‘ä»¬å‰æœŸå°½å¯èƒ½ç®€åŒ–ã€‚è€ƒè™‘ b ç«™æ”¶è—å¤¹å·²ç»æœ‰ç•Œé¢äº†ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥ä¾é™„åœ¨ä¸Šé¢ï¼Œè€Œä¸æ˜¯è‡ªå·±åšä¸€å¥—ï¼Ÿæµè§ˆå™¨ pop up åªæœ‰ 1. ç´¢å¼•å…¨éƒ¨åˆ—è¡¨ 2. å¯¹æ‰€æœ‰åˆ—è¡¨ç”³åŸå»ºè®®ï¼ˆç›´æ¥æŒ‰é’®åœ¨itemä¸‹å‘ï¼Œç‚¹å‡»å°±ç§»åŠ¨ï¼Œæœ‰ä¸ª 5s æ’¤é”€ toast ï¼Œä¸éœ€è¦æ°¸ä¹…è®°å¿†ï¼‰ 3. å¯¼å‡ºå·²ç»ç´¢å¼•åˆ—è¡¨ï¼ˆç›´æ¥jsonï¼‰4. ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»å¼¹çª—æ˜¾ç¤ºæ“ä½œæ—¥å¿—ï¼ˆæŸæŸmovedtoæŸæŸï¼Œå…¶ä»–ä¸éœ€è¦æ—¥å¿—ï¼‰ï¼ˆæ°¸ä¹…ï¼Œåªèƒ½çœ‹ï¼Œä¸å¯æ’¤å›æˆ–è€…è¿›ä¸€æ­¥æ“ä½œï¼‰ 3. é…ç½® claude key 4. æ¨¡å‹é€‰æ‹©ï¼ˆé»˜è®¤ haikuï¼‰ think what's our ultimiate goal and you are best product owner can think for long term design and product sake è¿›è¡Œé’ˆé”‹ç›¸å¯¹è‡ªæˆ‘è¾©è®ºï¼Œè®¨è®ºæŠ€æœ¯é€‰å‹å’ŒåŠŸèƒ½å­é›†å’Œé—æ¼äº†è¦åŠ ä»€ä¹ˆåŠŸèƒ½ï¼ˆéå¸¸å‘æ•£ç»™å¤§é‡é€‰é¡¹ç„¶åæŒ¨ä¸ªè¿›è¡Œå¤šè½®æ¬¡é’ˆé”‹ç›¸å¯¹è¾©è®ºï¼‰

---

## Part 1: æŠ€æœ¯é€‰å‹è¾©è®º

### é€‰å‹ 1: æ’ä»¶æ¡†æ¶ â€” WXT vs CRXJS vs Raw MV3

| | WXT | CRXJS | Raw Manifest V3 |
|---|---|---|---|
| **ä¼˜åŠ¿** | reedle-extension å·²éªŒè¯ âœ…; å†…ç½® HMR; defineBackground/defineContentScript å£°æ˜å¼ API; è·¨æµè§ˆå™¨ (Chrome+Firefox) | Vite åŸç”Ÿ; ç¤¾åŒºå¤§ | é›¶ä¾èµ–; å®Œå…¨æ§åˆ¶ |
| **åŠ£åŠ¿** | é¢å¤–æŠ½è±¡å±‚ | ç‰ˆæœ¬è¿­ä»£æ¿€è¿›; Firefox æ”¯æŒå¼± | å¼€å‘ä½“éªŒå·®; æ—  HMR |

**ç»“è®º**: **WXT**ã€‚reedle-extension å·²ç»è¯æ˜å…¶ç¨³å®šæ€§ï¼Œä½ ç†Ÿæ‚‰å®ƒï¼Œä¸”è·¨æµè§ˆå™¨æ”¯æŒå¼€ç®±å³ç”¨ã€‚æ²¡æœ‰ç†ç”±ä¸ç”¨å®ƒã€‚

### é€‰å‹ 2: çŠ¶æ€ç®¡ç† â€” Jotai vs Zustand vs Raw useState

**æ­£æ–¹ (Jotai)**: RainSorter ç”¨ Jotai + atomWithStorageï¼Œæ¨¡å¼æˆç†Ÿã€‚
**åæ–¹**: BiliSorter æ¯” RainSorter ç®€å•å¤ªå¤šâ€”â€”popup åªæœ‰å‡ ä¸ªæŒ‰é’®çŠ¶æ€ï¼›reedle-extension ç›´æ¥ç”¨ `useState` æå®š 588 è¡Œ `App.tsx`ã€‚å¼•å…¥ Jotai æ˜¯ over-engineeringã€‚

**ç»“è®º**: **ç›´æ¥ useState**ï¼Œå’Œ reedle-extension ä¿æŒä¸€è‡´ã€‚Popup çŠ¶æ€æç®€ï¼š`videos[]`, `folders[]`, `suggestions{}`, `loading`, `status`ã€‚ç”¨ `chrome.storage.local` æŒä¹…åŒ–å¿…è¦æ•°æ®ï¼ˆå’Œ WXT çš„ `storage` util é…åˆï¼‰ã€‚Jotai æ²¡æœ‰å¿…è¦ã€‚

### é€‰å‹ 3: Content Script æ³¨å…¥ vs Popup-Only

**æ­£æ–¹ (Content Script)**:
> "Bç«™æ”¶è—å¤¹å·²ç»æœ‰ UI äº†ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ä¸Šé¢å¢å¼ºï¼Œä¸éœ€è¦è‡ªå·±åšä¸€å¥— UIï¼"

- âœ… é›¶ UI å¼€å‘æˆæœ¬
- âœ… ç”¨æˆ·ä¸ç¦»å¼€ B ç«™
- âœ…  å¯ä»¥åœ¨è§†é¢‘ item æ—è¾¹ç›´æ¥æ³¨å…¥ AI å»ºè®®æŒ‰é’®

**åæ–¹ (Content Script)**:
> "Bç«™æ”¹ç‰ˆå³ç¢ã€‚2024å¹´ Bç«™ç©ºé—´é¡µå¤§æ”¹è¿‡ä¸€æ¬¡ï¼Œ2025å¹´æ”¶è—å¤¹åˆ—è¡¨åˆæ”¹è¿‡ã€‚æ¯æ¬¡æ”¹ç‰ˆ content script å…¨æŒ‚ã€‚ç»´æŠ¤æˆæœ¬æ˜¯å¼€å‘æˆæœ¬çš„ 3-5 å€ã€‚è€Œä¸” UI æ³¨å…¥æœ‰ CSS å†²çªé£é™©ã€z-index åœ°ç‹±ã€shadow DOM å…¼å®¹æ€§é—®é¢˜ã€‚reedle-extension çš„ content script åªåšæ•°æ®åŒæ­¥ï¼ˆè¯» localStorageï¼‰ï¼Œé›¶ UI æ³¨å…¥â€”â€”è¿™æ˜¯æ˜æ™ºçš„ã€‚"

**æ­£æ–¹åé©³**:
> "ä½†æˆ‘ä»¬å¯ä»¥åšæœ€å°æ³¨å…¥â€”â€”åªåœ¨æ”¶è—å¤¹é¡µé¢åŠ ä¸€ä¸ªæ‚¬æµ®æŒ‰é’®ï¼ˆæ‰“å¼€ popup/side panelï¼‰ï¼Œä¸ç›´æ¥æ”¹åŠ¨ B ç«™çš„ DOM ç»“æ„ã€‚"

**åæ–¹å†åé©³**:
> "é‚£å°±æ˜¯ popup === ä¸» UI çš„æ–¹æ¡ˆï¼Œcontent script åªæ˜¯ä¸ªè§¦å‘å™¨ã€‚è¿™æ²¡å¿…è¦â€”â€”ç‚¹æ’ä»¶å›¾æ ‡æ‰“å¼€ popup ä¸€æ ·çš„ã€‚"

**ç»“è®º**: **ä¸åš Content Script UI æ³¨å…¥**ã€‚Popup ä½œä¸ºå”¯ä¸€ UIã€‚Background SW åš cookie è¯»å–å’Œ API è°ƒç”¨ã€‚å’Œ reedle-extension æ¶æ„å®Œå…¨ä¸€è‡´ï¼š`background.ts` + `popup/`ã€‚ä¸åš `content.ts`ï¼ˆæˆ‘ä»¬ä¸éœ€è¦å’Œ B ç«™é¡µé¢åšæ•°æ®åŒæ­¥ï¼‰ã€‚

### é€‰å‹ 4: Side Panel vs Popup

**æ­£æ–¹ (Side Panel)**:
> "Popup æœ€å¤§ 800Ã—600pxï¼Œå…³é—­å°±ä¸¢çŠ¶æ€ã€‚Side Panel å¸¸é©»ï¼Œ400px å®½åº¦è¶³å¤Ÿåš list + sidebarã€‚"

**åæ–¹ (Popup)**:
> "æˆ‘ä»¬çš„ UI æç®€ï¼šä¸€ä¸ªåˆ—è¡¨ + æ¯é¡¹ä¸‹é¢ä¸€æ’ AI æŒ‰é’®ã€‚ä¸éœ€è¦ sidebarï¼Œä¸éœ€è¦ treeã€‚ç”¨æˆ·æ“ä½œæ˜¯ burst å¼çš„â€”â€”æ‰“å¼€ popupï¼Œçœ‹åˆ—è¡¨ï¼Œç‚¹å‡ ä¸ªæŒ‰é’®ï¼Œå…³é—­ã€‚ä¸éœ€è¦å¸¸é©»ã€‚Side Panel æ˜¯ Chrome 114+ featureï¼ŒFirefox ä¸æ”¯æŒã€‚è€Œä¸”å¢åŠ  manifest å¤æ‚åº¦ã€‚reedle-extension å°±æ˜¯ popupï¼Œå¤Ÿç”¨ã€‚"

**æ­£æ–¹åé©³**:
> "ä½†æ”¶è—å¤¹å¯èƒ½æœ‰å‡ ç™¾ä¸ªè§†é¢‘ï¼Œåˆ—è¡¨ä¼šå¾ˆé•¿â€”â€”"

**åæ–¹å†åé©³**:
> "å‡ ç™¾ä¸ªè§†é¢‘ä¸éœ€è¦ä¸€æ¬¡å…¨çœ‹åˆ°ã€‚æˆ‘ä»¬åšè™šæ‹Ÿæ»šåŠ¨æˆ–åˆ†é¡µã€‚Popup çš„ 600px é«˜åº¦è¶³ä»¥æ˜¾ç¤º 10+ æ¡è§†é¢‘å¡ç‰‡ã€‚å¤Ÿäº†ã€‚"

**ç»“è®º**: **Popup**ã€‚ä¿æŒæç®€ï¼Œå’Œ reedle-extension ä¸€è‡´ã€‚åæœŸå¦‚æœç”¨æˆ·åé¦ˆéœ€è¦æ›´å¤§ç©ºé—´ï¼Œå†è¿ç§»åˆ° Side Panelï¼ˆWXT æ”¯æŒ `defineUnlistedScript` / Side Panelï¼‰ã€‚

### é€‰å‹ 5: AI Provider â€” Claude vs OpenAI-compatible

**ç”¨æˆ·è¦æ±‚**: Claude key + é»˜è®¤ Haiku

**æ­£æ–¹ (Claude-only)**:
> "ç®€åŒ–ã€‚åªæ”¯æŒ Claude APIã€‚ä¸€ä¸ª `anthropicApi.ts` æå®šã€‚Haiku ä¾¿å®œã€å¿«é€Ÿã€ä¸­æ–‡å¥½ã€‚"

**åæ–¹ (å¤š provider å¯é€‰)**:
> "ä»¥åç”¨æˆ·å¯èƒ½æƒ³ç”¨ Deepseekï¼ˆæ›´ä¾¿å®œï¼‰ã€GPT-4o-miniã€æˆ–è€…æœ¬åœ° Ollamaã€‚åšä¸ª provider abstraction ä¸éš¾ã€‚"

**æ­£æ–¹åé©³**:
> "MVP åŸåˆ™ã€‚å…ˆåªæ”¯æŒ Claudeã€‚provider åˆ‡æ¢æ˜¯ Phase 2 çš„äº‹ã€‚ä»£ç é¢„ç•™æ¥å£å°±è¡Œï¼ˆä¸€ä¸ª `callLLM(prompt): Promise<Result>` å‡½æ•°ï¼‰ï¼Œä¸éœ€è¦ç°åœ¨åš UI é…ç½®ã€‚"

**ç»“è®º**: **MVP åªæ”¯æŒ Claudeï¼ˆHaiku é»˜è®¤ï¼‰**ã€‚é…ç½®é¡µåªéœ€ Claude API Key + æ¨¡å‹é€‰æ‹©ï¼ˆhaiku/sonnetï¼‰ã€‚ä»£ç å±‚é¢ç•™ä¸€ä¸ª `llmService.ts` æŠ½è±¡ï¼Œä»¥ä¾¿æœªæ¥åŠ  providerã€‚

---

## Part 2: åŠŸèƒ½é›†è¾©è®º

### ç”¨æˆ·æå‡ºçš„åŠŸèƒ½æ¸…å•å¤ç›˜

1. âœ… ç´¢å¼•å…¨éƒ¨æ”¶è—å¤¹åˆ—è¡¨
2. âœ… å¯¹æ‰€æœ‰ item ç”Ÿæˆå»ºè®®ï¼ˆAI badge + ç‚¹å‡»ç§»åŠ¨ + 5s æ’¤é”€ toastï¼‰
3. âœ… å¯¼å‡ºå·²ç´¢å¼•åˆ—è¡¨ï¼ˆJSONï¼‰
4. âœ… æ“ä½œæ—¥å¿—å¼¹çª—ï¼ˆæ°¸ä¹…ï¼Œåªè¯»ï¼‰
5. âœ… é…ç½® Claude key
6. âœ… æ¨¡å‹é€‰æ‹©ï¼ˆé»˜è®¤ Haikuï¼‰

### é—æ¼æ£€æŸ¥ â€” å‘æ•£ & è¾©è®º

#### å€™é€‰åŠŸèƒ½ A: "ç´¢å¼•å“ªä¸ªæ”¶è—å¤¹ï¼Ÿ"

**é—®é¢˜**: "ç´¢å¼•å…¨éƒ¨åˆ—è¡¨" â€” æ˜¯ç´¢å¼•"é»˜è®¤æ”¶è—å¤¹"ï¼ˆæœªåˆ†ç±»ï¼‰è¿˜æ˜¯æ‰€æœ‰æ”¶è—å¤¹ï¼Ÿ

**æ­£æ–¹ (åªç´¢å¼•é»˜è®¤æ”¶è—å¤¹)**:
> "å’Œ RainSorter ä¸€æ ·ï¼Œonly unsortedã€‚ç”¨æˆ·çš„è¯‰æ±‚å°±æ˜¯'å¸®æˆ‘æ•´ç†é»˜è®¤æ”¶è—å¤¹é‡Œçš„ä¹±ä¸ƒå…«ç³Ÿ'ã€‚"

**åæ–¹ (ç”¨æˆ·é€‰æ‹©æºæ”¶è—å¤¹)**:
> "å¾ˆå¤šäººä¸åªæ˜¯é»˜è®¤æ”¶è—å¤¹ä¹±ã€‚æœ€æ—©å¯èƒ½å»ºäº†ä¸ª'ç§‘æŠ€'æ–‡ä»¶å¤¹ï¼Œåæ¥åˆå»ºäº†'ç¼–ç¨‹'ï¼Œä¸¤ä¸ªæœ‰é‡å æƒ³åˆå¹¶ã€‚æˆ–è€…æƒ³ re-sort æŸä¸ªå·²æœ‰æ”¶è—å¤¹ã€‚"

**æ­£æ–¹åé©³**:
> "åˆå¹¶/re-sort æ˜¯ advanced featureã€‚MVP é”å®šé»˜è®¤æ”¶è—å¤¹ã€‚90% ç”¨æˆ·çš„ç—›ç‚¹å°±åœ¨è¿™é‡Œã€‚"

**ç»“è®º**: **MVP é»˜è®¤æ”¶è—å¤¹ï¼ˆç”¨æˆ·å¯é€‰æºæ”¶è—å¤¹ï¼Œé»˜è®¤é€‰ä¸­"é»˜è®¤æ”¶è—å¤¹"ï¼‰**ã€‚åŠ ä¸€ä¸ª dropdown é€‰æºæ”¶è—å¤¹æˆæœ¬å¾ˆä½ï¼Œä¸åŠ åè€Œè®©é«˜çº§ç”¨æˆ·å›°æ‰°ã€‚

#### å€™é€‰åŠŸèƒ½ B: Cookie è¿‡æœŸæ£€æµ‹ + æç¤º

**é—®é¢˜**: SESSDATA ~30å¤©è¿‡æœŸã€‚ç”¨æˆ·æ‰“å¼€æ’ä»¶æ—¶ cookie å¯èƒ½å·²å¤±æ•ˆã€‚

**æ‰€æœ‰äºº**: å¿…é¡»åšã€‚æ£€æµ‹åˆ° cookie æ— æ•ˆæ—¶æ˜¾ç¤º "è¯·å…ˆç™»å½• B ç«™" æç¤ºã€‚è¿™æ˜¯ UX åŸºæœ¬åŠŸã€‚

**ç»“è®º**: **å¿…é¡»åš**ã€‚Background SW è¯»å– cookie åå…ˆè°ƒä¸€ä¸ªè½»é‡ API éªŒè¯ï¼ˆå¦‚ `GET /x/web-interface/nav` è¿”å› `data.isLogin`ï¼‰ã€‚å¤±è´¥åˆ™ popup æ˜¾ç¤º "è¯·å…ˆç™»å½• bilibili.com"ã€‚

#### å€™é€‰åŠŸèƒ½ C: è§†é¢‘å°é¢ç¼©ç•¥å›¾

**æ­£æ–¹**:
> "Bç«™è§†é¢‘æœ‰å°é¢ã€‚æ˜¾ç¤ºç¼©ç•¥å›¾è®©ç”¨æˆ·æ›´å¿«è¯†åˆ«è§†é¢‘å†…å®¹ã€‚æ¯”çº¯æ–‡å­—åˆ—è¡¨å¥½ 10 å€ã€‚"

**åæ–¹**:
> "å¢åŠ è¯·æ±‚é‡ï¼ˆåŠ è½½å›¾ç‰‡ï¼‰ã€‚Popup å®½åº¦æœ‰é™ã€‚"

**æ­£æ–¹åé©³**:
> "å°é¢ URL åœ¨ fav/resource/list response é‡Œå·²ç»æœ‰äº†ï¼Œæ˜¯ç°æˆçš„ã€‚40Ã—30px çš„å°ç¼©ç•¥å›¾ä¸å ç©ºé—´ã€‚"

**ç»“è®º**: **åšã€‚**æˆæœ¬ä¸ºé›¶ï¼ˆæ•°æ®å·²æœ‰ï¼‰ï¼ŒUX æå‡å·¨å¤§ã€‚

#### å€™é€‰åŠŸèƒ½ D: "æ–°å»ºæ”¶è—å¤¹"

**é—®é¢˜**: AI åˆ†æå®Œå‘ç°æ²¡æœ‰åˆé€‚çš„æ”¶è—å¤¹ï¼Œç”¨æˆ·æƒ³æ–°å»ºä¸€ä¸ªã€‚

**æ­£æ–¹**: "ä¸åšã€‚è®©ç”¨æˆ·å» B ç«™é¡µé¢æ–°å»ºã€‚æˆ‘ä»¬åªåšåˆ†ç±»ï¼Œä¸åšåˆ›å»ºã€‚"
**åæ–¹**: "é‚£ç”¨æˆ·å°±è¦æ¥å›åˆ‡ã€‚åœ¨æ“ä½œæµé‡ŒåŠ ä¸€ä¸ª'+æ–°å»ºæ”¶è—å¤¹'æŒ‰é’®æˆæœ¬å¾ˆä½ã€‚"

**ç»“è®º**: **Phase 2 åš**ã€‚MVP åªç§»åŠ¨åˆ°ç°æœ‰æ”¶è—å¤¹ã€‚å»ºè®®æ–‡æ¡ˆæç¤º "å¦‚æœæ²¡æœ‰åˆé€‚çš„æ”¶è—å¤¹ï¼Œè¯·å…ˆå» B ç«™æ–°å»º"ã€‚

#### å€™é€‰åŠŸèƒ½ E: æ‰¹é‡ vs é€æ¡ AI å»ºè®®

**æ­£æ–¹ (é€æ¡)**:
> "æ¯ä¸ªè§†é¢‘å•ç‹¬ä¸€æ¬¡ LLM callã€‚ç®€å•ã€å¯é ã€‚"

**åæ–¹ (æ‰¹é‡)**:
> "Haiku å¾ˆå¿«ä½†ä¹Ÿä¸å…è´¹ã€‚100 ä¸ªè§†é¢‘ = 100 æ¬¡è¯·æ±‚ = é«˜å»¶è¿Ÿ + é«˜æˆæœ¬ã€‚æŠŠ 5-10 æ¡å¡è¿›ä¸€ä¸ª prompt æ•ˆç‡é«˜ 10 å€ã€‚"

**ç»“è®º**: **æ‰¹é‡**ã€‚æ¯æ¬¡ 5-10 ä¸ªè§†é¢‘ä¸€èµ·å‘ç»™ LLMï¼Œä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰åˆ†ç±»å»ºè®®ã€‚èŠ‚çœ tokenã€å‡å°‘å»¶è¿Ÿã€‚

#### å€™é€‰åŠŸèƒ½ F: å¤±æ•ˆè§†é¢‘å¤„ç†

**é—®é¢˜**: B ç«™æ”¶è—å¤¹å¸¸æœ‰"å·²å¤±æ•ˆè§†é¢‘"ï¼ˆè¢«åˆ é™¤/ä¸‹æ¶ï¼‰ã€‚

**æ­£æ–¹**: "æ ‡è®°å‡ºæ¥è®©ç”¨æˆ·çŸ¥é“ã€‚æ˜¾ç¤º [å·²å¤±æ•ˆ] æ ‡ç­¾ã€‚"
**åæ–¹**: "ä¸éœ€è¦ã€‚å¤±æ•ˆè§†é¢‘æ— æ³•ç§»åŠ¨ï¼ŒAPI æœ¬èº«ä¼šæŠ¥é”™ã€‚æˆ‘ä»¬ skip å°±è¡Œã€‚"

**ç»“è®º**: **æ ‡è®°æ˜¾ç¤ºä½†ä¸å¯¹å¤±æ•ˆè§†é¢‘ç”Ÿæˆå»ºè®®**ã€‚æˆæœ¬ä¸ºé›¶ï¼ˆ`attr` å­—æ®µåˆ¤æ–­ï¼‰ï¼ŒUX æœ‰ç›Šã€‚

#### å€™é€‰åŠŸèƒ½ G: è¿›åº¦åé¦ˆ

**é—®é¢˜**: æ‰¹é‡ AI å»ºè®®å¯èƒ½éœ€è¦ 10-30 ç§’ï¼ˆå¯¹å‡ ç™¾ä¸ªè§†é¢‘ï¼‰ã€‚

**ç»“è®º**: **å¿…é¡»åš**ã€‚è¿›åº¦æ¡æˆ– "æ­£åœ¨åˆ†æ... 23/142" è¿›åº¦æ–‡å­—ã€‚æ²¡æœ‰è¿›åº¦åé¦ˆ = ç”¨æˆ·ä»¥ä¸ºå¡æ­»ã€‚

#### å€™é€‰åŠŸèƒ½ H: ä¸€é”®å…¨éƒ¨åº”ç”¨

**æ­£æ–¹**: "ç”¨æˆ·å¯èƒ½çœ‹å®Œæ‰€æœ‰å»ºè®®åï¼Œä¸€é”®æŠŠæ‰€æœ‰é«˜ç½®ä¿¡åº¦ï¼ˆ>80%ï¼‰çš„è‡ªåŠ¨ç§»åŠ¨ã€‚"
**åæ–¹**: "å±é™©æ“ä½œï¼Œå¯èƒ½è¯¯åˆ†ç±»ã€‚5s toast æ’¤é”€ä¸å¤Ÿæ’¤å‡ åæ¡ã€‚"

**æ­£æ–¹åé©³**: "åŠ ä¸€ä¸ªç¡®è®¤å¼¹çª—ï¼š'å³å°†ç§»åŠ¨ 42 ä¸ªè§†é¢‘åˆ°å»ºè®®çš„æ”¶è—å¤¹ï¼Œç¡®è®¤ï¼Ÿ'"

**ç»“è®º**: **Phase 2**ã€‚MVP é€æ¡ç‚¹å‡»æ›´å®‰å…¨ã€‚åæœŸåŠ  "Apply All (high confidence)" æŒ‰é’®ã€‚

#### å€™é€‰åŠŸèƒ½ I: è®°ä½ä¸Šæ¬¡ç´¢å¼•ç»“æœ

**æ­£æ–¹**: "æŠŠç´¢å¼•ç»“æœç¼“å­˜åˆ° chrome.storage.localã€‚ä¸‹æ¬¡æ‰“å¼€ popup ä¸éœ€è¦é‡æ–°æ‹‰å–ã€‚"
**åæ–¹**: "æ”¶è—å¤¹æ˜¯æ´»çš„ï¼Œæ¯æ¬¡æ‰“å¼€éƒ½å¯èƒ½å˜ã€‚ç¼“å­˜ä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´ã€‚"

**æ­£æ–¹åé©³**: "æ˜¾ç¤ºç¼“å­˜æ•°æ® + ä¸€ä¸ª Refresh æŒ‰é’®ã€‚å’Œ RainSorter ä¸€æ ·ã€‚ç”¨æˆ·ä½“éªŒæ›´å¥½â€”â€”æ‰“å¼€å³è§ï¼Œè€Œä¸æ˜¯æ¯æ¬¡ç­‰ loadingã€‚"

**ç»“è®º**: **åš**ã€‚ç¼“å­˜ç´¢å¼•ç»“æœåˆ° `chrome.storage.local`ã€‚æ‰“å¼€æ—¶æ˜¾ç¤ºç¼“å­˜ + "Refresh" æŒ‰é’®ã€‚AI å»ºè®®å¦å¤–ç¼“å­˜ï¼ˆä¸å’Œè§†é¢‘åˆ—è¡¨ç»‘å®šï¼Œå› ä¸ºå»ºè®®å¯èƒ½å·²è¿‡æ—¶ï¼‰ã€‚

---

## Part 3: æœ€ç»ˆåŠŸèƒ½æ¸…å•ï¼ˆåˆ†ä¼˜å…ˆçº§ï¼‰

### MVP (v0.1) â€” å¿…é¡»åš

| # | åŠŸèƒ½ | ç»†èŠ‚ |
|---|---|---|
| 1 | **è®¤è¯ä¸ç™»å½•æ£€æµ‹** | Background SW ç”¨ `chrome.cookies.get` è¯» SESSDATA + bili_jct + DedeUserIDã€‚è°ƒ `/x/web-interface/nav` éªŒè¯æœ‰æ•ˆæ€§ã€‚æ— æ•ˆåˆ™ popup æ˜¾ç¤º"è¯·å…ˆç™»å½• bilibili.com" |
| 2 | **ç´¢å¼•æ”¶è—å¤¹åˆ—è¡¨** | æŒ‰é’® "ğŸ“¥ ç´¢å¼•æ”¶è—å¤¹"ã€‚åŠ è½½ç”¨æˆ·æ‰€æœ‰æ”¶è—å¤¹ + é€‰å®šæºæ”¶è—å¤¹ï¼ˆé»˜è®¤"é»˜è®¤æ”¶è—å¤¹"ï¼‰çš„å…¨éƒ¨è§†é¢‘ã€‚å¸¦è¿›åº¦åé¦ˆã€‚ç»“æœç¼“å­˜åˆ° chrome.storage.local |
| 3 | **è§†é¢‘åˆ—è¡¨å±•ç¤º** | æ¯æ¡ï¼šç¼©ç•¥å›¾ + æ ‡é¢˜ + UPä¸» + åˆ†åŒº tagã€‚å¤±æ•ˆè§†é¢‘æ ‡è®° [å·²å¤±æ•ˆ] ç°æ˜¾ |
| 4 | **AI æ‰¹é‡å»ºè®®** | æŒ‰é’® "âœ¨ ç”Ÿæˆå»ºè®®"ã€‚æŠŠè§†é¢‘åˆ†æ‰¹(5-10)å‘ç»™ Claudeï¼Œè¿”å›æ¨èæ”¶è—å¤¹+ç½®ä¿¡åº¦ã€‚æ¯æ¡è§†é¢‘ä¸‹é¢æ˜¾ç¤º AI badge(s) |
| 5 | **ä¸€é”®ç§»åŠ¨ + 5s æ’¤é”€ Toast** | ç‚¹å‡» AI badge â†’ 5s toast "å·²ç§»åŠ¨åˆ° [æ”¶è—å¤¹åç§°] â€” æ’¤é”€"ã€‚5s å†…ç‚¹æ’¤é”€åˆ™å–æ¶ˆç§»åŠ¨ã€‚5s åæ‰§è¡Œ API è°ƒç”¨ã€‚**ä¸éœ€è¦æ°¸ä¹… undo** |
| 6 | **å¯¼å‡º JSON** | æŒ‰é’® "ğŸ“¤ å¯¼å‡º JSON"ã€‚æŠŠå½“å‰ç´¢å¼•çš„è§†é¢‘åˆ—è¡¨ï¼ˆå« AI å»ºè®®ï¼‰å¯¼å‡ºä¸º JSON æ–‡ä»¶ä¸‹è½½ |
| 7 | **æ“ä½œæ—¥å¿—å¼¹çª—** | æŒ‰é’® "ğŸ“‹ æ“ä½œæ—¥å¿—"ã€‚å¼¹çª—æ˜¾ç¤ºå†å²ç§»åŠ¨è®°å½•ï¼š"ã€Šè§†é¢‘æ ‡é¢˜ã€‹â†’ [æ”¶è—å¤¹åç§°]" + æ—¶é—´æˆ³ã€‚æ°¸ä¹…å­˜å‚¨åœ¨ chrome.storage.localã€‚åªè¯»ï¼Œä¸å¯æ’¤å› |
| 8 | **Claude API é…ç½®** | Settings åŒºåŸŸï¼šAPI Key è¾“å…¥æ¡† + æ¨¡å‹ selectï¼ˆhaiku/sonnetï¼‰ã€‚å­˜å‚¨åœ¨ chrome.storage.local |

### Phase 2 â€” åç»­è¿­ä»£

| # | åŠŸèƒ½ |
|---|---|
| 9 | å¤š AI Providerï¼ˆDeepseek, OpenAI, Ollamaï¼‰ |
| 10 | ä¸€é”®åº”ç”¨å…¨éƒ¨é«˜ç½®ä¿¡åº¦å»ºè®®ï¼ˆå«ç¡®è®¤å¼¹çª—ï¼‰ |
| 11 | æ–°å»ºæ”¶è—å¤¹ï¼ˆä» popup å†…ç›´æ¥åˆ›å»ºï¼‰ |
| 12 | é‡å¤è§†é¢‘æ£€æµ‹ï¼ˆåŒä¸€è§†é¢‘å‡ºç°åœ¨å¤šä¸ªæ”¶è—å¤¹ï¼‰ |

---

## Part 4: æ¶æ„å®šç¨¿

```
bilisorter/
â”œâ”€â”€ apps/
â”‚   â””â”€â”€ bilisorter-ext/           # WXT Chrome Extension
â”‚       â”œâ”€â”€ entrypoints/
â”‚       â”‚   â”œâ”€â”€ background.ts     # Service Worker: cookie è¯»å–, Bç«™ API è°ƒç”¨, Claude API è°ƒç”¨
â”‚       â”‚   â””â”€â”€ popup/            # Popup UI (React)
â”‚       â”‚       â”œâ”€â”€ App.tsx       # ä¸»ç»„ä»¶ï¼šåˆ—è¡¨ + æŒ‰é’® + toast + æ—¥å¿—å¼¹çª—
â”‚       â”‚       â”œâ”€â”€ App.css       # æ ·å¼ï¼ˆæš—è‰²ä¸»é¢˜ï¼‰
â”‚       â”‚       â”œâ”€â”€ index.html
â”‚       â”‚       â””â”€â”€ main.tsx
â”‚       â”œâ”€â”€ lib/
â”‚       â”‚   â”œâ”€â”€ bilibiliApi.ts    # Bç«™ API endpoints å°è£…
â”‚       â”‚   â”œâ”€â”€ claudeApi.ts      # Claude API è°ƒç”¨å°è£…
â”‚       â”‚   â”œâ”€â”€ constants.ts      # å¸¸é‡
â”‚       â”‚   â””â”€â”€ types.ts          # TypeScript ç±»å‹
â”‚       â”œâ”€â”€ public/
â”‚       â”‚   â””â”€â”€ icon/             # æ‰©å±•å›¾æ ‡
â”‚       â”œâ”€â”€ wxt.config.ts         # WXT é…ç½®
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ tsconfig.json
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ research.md
â””â”€â”€ README.md
```

**Manifest permissions**:
```
permissions: ["cookies", "storage"]
host_permissions: ["*://*.bilibili.com/*", "https://api.bilibili.com/*"]
```

**æ•°æ®æµ**:
```
Popup App.tsx
  â†’ chrome.runtime.sendMessage({type: 'FETCH_FOLDERS'})
  â†’ background.ts: chrome.cookies.get â†’ fetch(bilibili API) â†’ sendResponse
  â†’ Popup: setState(folders)

  â†’ chrome.runtime.sendMessage({type: 'FETCH_VIDEOS', folderId})
  â†’ background.ts: fetch(bilibili_fav_resource_list) â†’ sendResponse
  â†’ Popup: setState(videos), chrome.storage.local.set(cache)

  â†’ chrome.runtime.sendMessage({type: 'GET_SUGGESTIONS', videos, folders})
  â†’ background.ts: fetch(claude API, batch prompt) â†’ sendResponse
  â†’ Popup: setState(suggestions)

  â†’ chrome.runtime.sendMessage({type: 'MOVE_VIDEO', src, dst, resource})
  â†’ background.ts: fetch(bilibili_move) â†’ sendResponse
  â†’ Popup: toast + append to operation log
```
